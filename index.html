<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Tokat Oyunu</title>

<style>
body {
  margin: 0;
  min-height: 100vh;
  display: grid;
  place-items: center;
  background: #0f1220;
  font-family: system-ui, sans-serif;
}

.card {
  width: 90vw;
  max-width: 420px;
  background: #161a33;
  padding: 16px;
  border-radius: 18px;
  color: white;
  text-align: center;
}

.photo-wrap {
  position: relative;
  overflow: hidden;
  border-radius: 14px;
}

#face {
  width: 100%;
  display: block;
  transition: transform 0.08s ease;
}

#face.slap {
  transform: translateX(6px) rotate(1deg);
}

/* YÃœZ KIZARMA / MORARMA */
#damage {
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at 50% 60%, rgba(180,0,0,0.0), rgba(120,0,0,0.0));
  pointer-events: none;
  transition: background 0.3s ease;
}

/* EL */
#hand {
  position: absolute;
  width: 140px;
  right: -160px;
  top: 50%;
  transform: translateY(-50%);
  opacity: 0;
  pointer-events: none;
}

#hand.active {
  animation: handHit 0.18s ease-out forwards;
}

@keyframes handHit {
  0%   { right: -160px; opacity: 0; }
  30%  { opacity: 1; }
  100% { right: 40%; opacity: 0; }
}

/* KAN */
.blood {
  position: absolute;
  width: 14px;
  height: 14px;
  background: darkred;
  border-radius: 50%;
  pointer-events: none;
  animation: bloodFly 0.9s forwards;
}

@keyframes bloodFly {
  from { opacity: 1; transform: translate(0,0) scale(1); }
  to   { opacity: 0; transform: translate(var(--dx), var(--dy)) scale(0.6); }
}

button {
  margin-top: 12px;
  padding: 10px 16px;
  border-radius: 999px;
  border: none;
  font-weight: bold;
}
</style>
</head>

<body>
<div class="card">
  <h3>Sinirlendin mi? Dokun ðŸ˜ˆ</h3>

  <div class="photo-wrap" id="wrap">
    <img id="face" src="face.jpg">
    <div id="damage"></div>
    <img id="hand" src="hand.png">
  </div>

  <p>Tokat: <span id="count">0</span></p>
  <button id="reset">SÄ±fÄ±rla</button>
</div>

<audio id="slapSound" src="slap.mp3"></audio>
<audio id="angrySound" src="angry.mp3"></audio>

<script>
const wrap = document.getElementById("wrap");
const face = document.getElementById("face");
const hand = document.getElementById("hand");
const damage = document.getElementById("damage");
const countEl = document.getElementById("count");
const slapSound = document.getElementById("slapSound");
const angrySound = document.getElementById("angrySound");

let count = Number(localStorage.getItem("slap") || 0);
countEl.textContent = count;

function vibrate() {
  if (navigator.vibrate) navigator.vibrate(120);
}

function updateDamage() {
  const level = Math.min(count / 5, 5);
  damage.style.background = `radial-gradient(circle at 50% 60%, rgba(180,0,0,${0.1*level}), rgba(80,0,80,${0.08*level}))`;
}

function blood(x, y) {
  for (let i = 0; i < 8; i++) {
    const b = document.createElement("div");
    b.className = "blood";
    b.style.left = x + "px";
    b.style.top = y + "px";
    b.style.setProperty("--dx", (Math.random()*80-40)+"px");
    b.style.setProperty("--dy", (Math.random()*80-20)+"px");
    wrap.appendChild(b);
    setTimeout(() => b.remove(), 900);
  }
}

wrap.addEventListener("pointerdown", e => {
  const r = wrap.getBoundingClientRect();
  const x = e.clientX - r.left;
  const y = e.clientY - r.top;

  count++;
  localStorage.setItem("slap", count);
  countEl.textContent = count;

  face.classList.remove("slap");
  hand.classList.remove("active");
  void face.offsetWidth;
  void hand.offsetWidth;

  face.classList.add("slap");
  hand.classList.add("active");

  blood(x, y);
  updateDamage();
  vibrate();

  try { slapSound.currentTime = 0; slapSound.play(); } catch {}

  if (count % 5 === 0) {
    try { angrySound.currentTime = 0; angrySound.play(); } catch {}
  }
});

document.getElementById("reset").onclick = () => {
  count = 0;
  localStorage.setItem("slap", 0);
  countEl.textContent = 0;
  damage.style.background = "transparent";
};
</script>
</body>
</html>
